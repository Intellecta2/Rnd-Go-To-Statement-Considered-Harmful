<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Draft: Go To Statement Considered Harmful | RaSor Research</title>
    
    <!-- Chosen Palette: "Academic Elegance" 
         Background: White / Slate-50 (Paper feel)
         Text: Slate-900 (High contrast for reading)
         Accent: Indigo-700 (Professional, trustworthy)
         Highlight: Amber-100 (Marker pen effect)
    -->

    <!-- Application Structure Plan:
         1. Header: Professional RaSor branding.
         2. Layout: Two-column 'Scrollytelling' layout on desktop. 
            - Left Column: The narrative research paper (Abstract, Intro, Analysis, Conclusion).
            - Right Column: Sticky sidebar containing dynamic "Figures" that update via Intersection Observer.
         3. Interactive Elements:
            - Figure 1 (Canvas): Visualizes the "Coordinate System" problem (Chaos vs. Linear).
            - Figure 2 (Chart.js): Quantifies the "Cognitive Gap" over time.
            - Figure 3 (Code): Interactive comparison of legacy vs. modern syntax.
    -->

    <!-- Visualization & Content Choices:
         - Canvas Simulation: Used to visually prove Dijkstra's point about "dynamic process" vs "static text".
         - Line Chart: Demonstrates the exponential difficulty of verifying unstructured code.
         - No SVG/Mermaid: All visuals are code-generated or HTML/CSS based.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Merriweather', 'serif'],
                    },
                    colors: {
                        paper: '#fdfbf7', // Slight warm white for reading comfort
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #fdfbf7; color: #1e293b; }
        
        /* Academic Formatting */
        .citation { color: #4338ca; cursor: pointer; font-size: 0.8em; vertical-align: super; font-weight: bold; }
        .citation:hover { text-decoration: underline; }
        
        .paper-title { line-height: 1.2; letter-spacing: -0.02em; }
        
        /* Scrollytelling Layout */
        .sticky-viz {
            position: sticky;
            top: 2rem;
            height: calc(100vh - 4rem);
            transition: all 0.5s ease;
        }
        
        /* Code Block Styling */
        .code-window {
            background: #1e293b;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.2);
            font-family: monospace;
            font-size: 0.85rem;
        }
        
        .active-section { border-left: 4px solid #4338ca; padding-left: 1rem; transition: border 0.3s; }
        
        /* Animation Utils */
        .fade-enter { opacity: 0; transform: translateY(10px); }
        .fade-enter-active { opacity: 1; transform: translateY(0); transition: opacity 0.5s, transform 0.5s; }
    </style>
</head>
<body class="antialiased">

    <!-- Professional Header -->
    <header class="border-b border-slate-200 bg-white/80 backdrop-blur-md fixed top-0 w-full z-50 h-16 flex items-center">
        <div class="container mx-auto px-6 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-indigo-700 rounded flex items-center justify-center text-white font-bold font-serif">R</div>
                <div>
                    <h1 class="text-sm font-bold text-slate-900 leading-none">RaSor Research</h1>
                    <p class="text-[10px] text-slate-500 uppercase tracking-wider">Core Team Draft</p>
                </div>
            </div>
            <div class="text-xs font-medium text-slate-400">
                Submission ID: <span class="text-slate-900">DJK-68-REF</span>
            </div>
        </div>
    </header>

    <!-- Main Content Grid -->
    <main class="container mx-auto px-6 pt-32 pb-24">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">
            
            <!-- Left Column: The Research Paper (Scrollable) -->
            <div class="lg:col-span-5 space-y-24 pb-32">
                
                <!-- Title Block -->
                <section id="intro" class="scroll-trigger" data-viz="intro-viz">
                    <span class="text-indigo-600 font-bold text-xs uppercase tracking-widest mb-2 block">Computer Science Classics</span>
                    <h1 class="paper-title text-4xl md:text-5xl font-serif font-black text-slate-900 mb-6">
                        Go To Statement Considered Harmful
                    </h1>
                    <div class="flex items-center gap-4 text-sm text-slate-600 mb-8 border-l-2 border-slate-200 pl-4">
                        <div>
                            <p class="font-bold text-slate-900">Edsger W. Dijkstra</p>
                            <p>Analyzed by RaSor Core Team</p>
                        </div>
                        <div class="h-8 w-px bg-slate-200"></div>
                        <div>
                            <p>Original: March 1968</p>
                            <p>Draft Rev: Nov 2025</p>
                        </div>
                    </div>
                    
                    <h3 class="font-bold text-slate-900 mt-8 mb-2">Abstract</h3>
                    <p class="font-serif text-slate-700 leading-relaxed">
                        The unrestricted use of the <code>goto</code> statement has been identified as a primary contributor to software complexity. This analysis explores the "Cognitive Gap" theory proposed by Dijkstra, demonstrating that the quality of programmers is a decreasing function of the density of jump statements in their code.
                    </p>
                </section>

                <!-- Section 1: The Problem -->
                <section id="chaos" class="scroll-trigger p-4 -ml-4 rounded-lg transition-colors hover:bg-white" data-viz="chaos-viz">
                    <h2 class="text-2xl font-bold text-slate-900 mb-4 font-sans">1. The Crisis of Chaos</h2>
                    <p class="font-serif text-lg text-slate-700 leading-relaxed mb-6">
                        In 1968, the software industry faced a crisis. As programs grew larger, they became impossible to debug. Dijkstra identified the culprit: the disconnect between the <strong>static program</strong> (the code on the page) and the <strong>dynamic process</strong> (the execution in time).
                    </p>
                    <p class="font-serif text-lg text-slate-700 leading-relaxed">
                        With <span class="bg-red-100 text-red-800 px-1 rounded font-mono text-sm">GOTO</span>, the execution path can jump arbitrarily. A reader at line 50 has no way of knowing if they arrived from line 49, line 10, or line 500. This destroys our ability to track the "coordinates" of the process.
                    </p>
                </section>

                <!-- Section 2: The Cognitive Gap -->
                <section id="gap" class="scroll-trigger p-4 -ml-4 rounded-lg transition-colors hover:bg-white" data-viz="gap-viz">
                    <h2 class="text-2xl font-bold text-slate-900 mb-4 font-sans">2. The "Cognitive Gap"</h2>
                    <p class="font-serif text-lg text-slate-700 leading-relaxed mb-6">
                        Dijkstra argued that the human mind has a limited buffer for complexity. We rely on patterns to understand systems.
                    </p>
                    <p class="font-serif text-lg text-slate-700 leading-relaxed">
                        As shown in <strong>Figure 2</strong>, the mental effort required to verify a program grows linearly with structured code, but exponentially with unstructured code. Once the "spaghetti" exceeds a certain density, it surpasses the "skull size" of even the best engineers.
                    </p>
                </section>

                <!-- Section 3: The Solution -->
                <section id="order" class="scroll-trigger p-4 -ml-4 rounded-lg transition-colors hover:bg-white" data-viz="order-viz">
                    <h2 class="text-2xl font-bold text-slate-900 mb-4 font-sans">3. Restoring Order</h2>
                    <p class="font-serif text-lg text-slate-700 leading-relaxed mb-6">
                        The solution was radical but simple: restrict control flow to three constructs that guarantee a predictable path.
                    </p>
                    <ul class="list-disc list-inside font-serif text-slate-700 space-y-2 mb-6 ml-4">
                        <li><strong>Sequence:</strong> Do A, then B.</li>
                        <li><strong>Selection:</strong> If X, do A, else B.</li>
                        <li><strong>Iteration:</strong> While X, do A.</li>
                    </ul>
                    <p class="font-serif text-lg text-slate-700 leading-relaxed">
                        By enforcing these rules, we ensure that the gap between the static code and the dynamic process remains small. The code looks like the execution.
                    </p>
                </section>

                <!-- Section 4: Code Comparison -->
                <section id="code" class="scroll-trigger p-4 -ml-4 rounded-lg transition-colors hover:bg-white" data-viz="code-viz">
                    <h2 class="text-2xl font-bold text-slate-900 mb-4 font-sans">4. Practical Application</h2>
                    <p class="font-serif text-lg text-slate-700 leading-relaxed mb-6">
                        The difference is not just theoretical. It is visibly apparent in the code structure. 
                    </p>
                    <p class="font-serif text-lg text-slate-700 leading-relaxed">
                        In <strong>Figure 3</strong>, notice how the legacy code requires scanning up and down to find labels. The modern refactor localizes logic within brackets <code>{}</code>, freeing the mind from tracking global state.
                    </p>
                </section>

                <hr class="border-slate-200">
                
                <section class="text-sm text-slate-500">
                    <p><strong>References:</strong></p>
                    <p>1. Dijkstra, E. W. (1968). "Go To Statement Considered Harmful". Communications of the ACM.</p>
                    <p>2. RaSor Internal Documentation, 2025.</p>
                </section>

            </div>

            <!-- Right Column: Sticky Visualization Sidebar -->
            <div class="hidden lg:block lg:col-span-7 relative">
                <div class="sticky-viz flex items-center justify-center">
                    
                    <!-- Container for Dynamic Visuals -->
                    <div class="w-full max-w-2xl bg-white border border-slate-200 rounded-xl shadow-2xl overflow-hidden relative h-[600px]">
                        
                        <!-- Header for the Figure -->
                        <div class="bg-slate-50 border-b border-slate-200 px-6 py-3 flex justify-between items-center">
                            <span class="text-xs font-bold text-slate-500 uppercase tracking-widest" id="fig-label">Figure 1: Concept</span>
                            <span class="text-xs font-serif italic text-slate-400" id="fig-desc">Select a section to view analysis</span>
                        </div>

                        <!-- Viz 1: Canvas (Introduction / Chaos / Order) -->
                        <div id="canvas-container" class="absolute inset-0 top-10 transition-opacity duration-500 opacity-100 bg-slate-50">
                            <canvas id="simulationCanvas" class="w-full h-full"></canvas>
                            <div class="absolute bottom-6 left-6 right-6 bg-white/90 backdrop-blur p-4 rounded border border-slate-100 text-sm text-slate-600 shadow-sm">
                                <strong>Simulation Status:</strong> <span id="sim-status" class="text-indigo-600">Initializing...</span>
                            </div>
                        </div>

                        <!-- Viz 2: Chart (The Gap) -->
                        <div id="chart-container" class="absolute inset-0 top-10 transition-opacity duration-500 opacity-0 bg-white flex items-center justify-center p-8">
                            <div class="w-full h-full">
                                <canvas id="gapChart"></canvas>
                            </div>
                        </div>

                        <!-- Viz 3: Code Comparison -->
                        <div id="code-container" class="absolute inset-0 top-10 transition-opacity duration-500 opacity-0 bg-slate-900 p-8 overflow-auto">
                            <div class="grid grid-cols-2 gap-4 h-full">
                                <div class="border-r border-slate-700 pr-4">
                                    <div class="text-red-400 text-xs uppercase font-bold mb-2">Legacy (Unstructured)</div>
                                    <pre class="text-slate-300 text-xs leading-loose">
<span class="text-purple-400">int</span> i = 0;
<span class="text-yellow-400">START:</span>
  <span class="text-purple-400">if</span> (i > 10) <span class="text-red-400">goto</span> <span class="text-yellow-400">END;</span>
  <span class="text-purple-400">if</span> (arr[i] == 0) <span class="text-red-400">goto</span> <span class="text-yellow-400">SKIP;</span>
  process(i);
<span class="text-yellow-400">SKIP:</span>
  i++;
  <span class="text-red-400">goto</span> <span class="text-yellow-400">START;</span>
<span class="text-yellow-400">END:</span>
  finish();</pre>
                                </div>
                                <div class="pl-4">
                                    <div class="text-green-400 text-xs uppercase font-bold mb-2">Modern (Structured)</div>
                                    <pre class="text-slate-300 text-xs leading-loose">
<span class="text-slate-500">// Logic contained in block</span>
<span class="text-purple-400">for</span> (<span class="text-purple-400">let</span> i = 0; i <= 10; i++) {
  
  <span class="text-purple-400">if</span> (arr[i] !== 0) {
    process(i);
  }

}

finish();</pre>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Logic -->
    <script>
        // --- 1. State Management ---
        let currentViz = 'intro-viz';
        
        // --- 2. Scrollytelling Logic (Intersection Observer) ---
        const observerOptions = {
            root: null,
            rootMargin: '-40% 0px -40% 0px', // Active when element is in middle 20% of screen
            threshold: 0
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const sectionId = entry.target.getAttribute('data-viz');
                    updateVisualization(sectionId);
                    
                    // Highlight text section
                    document.querySelectorAll('.scroll-trigger').forEach(el => el.classList.remove('active-section'));
                    entry.target.classList.add('active-section');
                }
            });
        }, observerOptions);

        document.querySelectorAll('.scroll-trigger').forEach(section => {
            observer.observe(section);
        });

        // --- 3. Visualization Switcher ---
        function updateVisualization(vizId) {
            if (vizId === currentViz) return;
            currentViz = vizId;

            // Labels
            const label = document.getElementById('fig-label');
            const desc = document.getElementById('fig-desc');
            const status = document.getElementById('sim-status');

            // Containers
            const canvasCont = document.getElementById('canvas-container');
            const chartCont = document.getElementById('chart-container');
            const codeCont = document.getElementById('code-container');

            // Reset opacities
            canvasCont.classList.remove('opacity-100'); canvasCont.classList.add('opacity-0');
            chartCont.classList.remove('opacity-100'); chartCont.classList.add('opacity-0');
            codeCont.classList.remove('opacity-100'); codeCont.classList.add('opacity-0');

            // Logic based on ID
            if (vizId === 'intro-viz' || vizId === 'chaos-viz' || vizId === 'order-viz') {
                canvasCont.classList.remove('opacity-0');
                canvasCont.classList.add('opacity-100');
                
                if (vizId === 'chaos-viz') {
                    label.innerText = "Figure 1: The Chaos Engine";
                    desc.innerText = "Simulating unstructured execution paths";
                    status.innerText = "Mode: UNSTRUCTURED (GOTO)";
                    setSimulationMode('chaos');
                } else if (vizId === 'order-viz') {
                    label.innerText = "Figure 3: Structural Harmony";
                    desc.innerText = "Restricting flow to linear sequences";
                    status.innerText = "Mode: STRUCTURED (LOOPS)";
                    setSimulationMode('order');
                } else {
                    label.innerText = "Figure 1: Introduction";
                    status.innerText = "Waiting for analysis...";
                    setSimulationMode('idle');
                }

            } else if (vizId === 'gap-viz') {
                chartCont.classList.remove('opacity-0');
                chartCont.classList.add('opacity-100');
                label.innerText = "Figure 2: The Cognitive Gap";
                desc.innerText = "Complexity vs. Program Size";
                
            } else if (vizId === 'code-viz') {
                codeCont.classList.remove('opacity-0');
                codeCont.classList.add('opacity-100');
                label.innerText = "Figure 4: Syntax Comparison";
                desc.innerText = "Legacy C vs. Modern JS";
            }
        }

        // --- 4. Canvas Simulation (Chaos vs Order) ---
        const canvas = document.getElementById('simulationCanvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        let simMode = 'idle';
        let animationId;

        function resizeCanvas() {
            const parent = canvas.parentElement;
            canvas.width = parent.clientWidth;
            canvas.height = parent.clientHeight;
            initParticles();
        }
        window.addEventListener('resize', resizeCanvas);

        function initParticles() {
            particles = [];
            const count = 50;
            for(let i=0; i<count; i++) {
                particles.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    vx: (Math.random() - 0.5) * 2,
                    vy: (Math.random() - 0.5) * 2,
                    color: '#4338ca' // Indigo-700
                });
            }
        }

        function setSimulationMode(mode) {
            simMode = mode;
            initParticles(); // Reset positions on change
        }

        function drawConnection(p1, p2, color, width) {
            ctx.beginPath();
            ctx.strokeStyle = color;
            ctx.lineWidth = width;
            ctx.moveTo(p1.x, p1.y);
            ctx.lineTo(p2.x, p2.y);
            ctx.stroke();
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            if (simMode === 'chaos') {
                // Chaos Logic: Random movement, red lines connecting far points (GOTO)
                particles.forEach(p => {
                    p.x += p.vx * 3; // Fast
                    p.y += p.vy * 3;
                    
                    // Wrap around
                    if (p.x < 0) p.x = canvas.width;
                    if (p.x > canvas.width) p.x = 0;
                    if (p.y < 0) p.y = canvas.height;
                    if (p.y > canvas.height) p.y = 0;

                    ctx.fillStyle = '#ef4444'; // Red
                    ctx.beginPath(); ctx.arc(p.x, p.y, 3, 0, Math.PI*2); ctx.fill();
                });

                // Draw random "GOTO" lines
                for(let i=0; i<particles.length; i++) {
                    if(Math.random() > 0.95) { // Random jumps
                        const target = particles[Math.floor(Math.random() * particles.length)];
                        drawConnection(particles[i], target, 'rgba(239, 68, 68, 0.3)', 1);
                    }
                }

            } else if (simMode === 'order') {
                // Order Logic: Stream movement, blue lines connecting neighbors
                particles.forEach((p, index) => {
                    p.x += 1; // Steady flow right
                    p.y += Math.sin(p.x * 0.01 + index) * 0.5; // Slight wave

                    if (p.x > canvas.width) p.x = 0;

                    ctx.fillStyle = '#4338ca'; // Indigo
                    ctx.beginPath(); ctx.arc(p.x, p.y, 3, 0, Math.PI*2); ctx.fill();
                    
                    // Connect to next particle (Sequence)
                    if (index < particles.length - 1) {
                         // Find nearest neighbor for visual smoothness
                         const neighbor = particles[(index + 1) % particles.length];
                         if (Math.abs(p.x - neighbor.x) < 100) {
                             drawConnection(p, neighbor, 'rgba(67, 56, 202, 0.2)', 2);
                         }
                    }
                });
            } else {
                // Idle: Just float
                particles.forEach(p => {
                    p.x += p.vx * 0.5;
                    p.y += p.vy * 0.5;
                    if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
                    if (p.y < 0 || p.y > canvas.height) p.vy *= -1;
                    ctx.fillStyle = '#94a3b8'; // Slate
                    ctx.beginPath(); ctx.arc(p.x, p.y, 2, 0, Math.PI*2); ctx.fill();
                });
            }

            animationId = requestAnimationFrame(animate);
        }

        setTimeout(() => {
            resizeCanvas();
            animate();
        }, 100);

        // --- 5. Chart.js Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            const ctxGap = document.getElementById('gapChart').getContext('2d');
            new Chart(ctxGap, {
                type: 'line',
                data: {
                    labels: ['10 LoC', '50 LoC', '100 LoC', '500 LoC', '1000 LoC'],
                    datasets: [{
                        label: 'Unstructured (GOTO)',
                        data: [5, 25, 80, 400, 950], // Exponential
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Structured',
                        data: [5, 10, 20, 45, 90], // Linear/Log
                        borderColor: '#4338ca',
                        backgroundColor: 'rgba(67, 56, 202, 0.1)',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: { display: true, text: 'Verification Effort vs. Code Size' },
                        legend: { position: 'bottom' }
                    },
                    scales: {
                        y: { title: { display: true, text: 'Cognitive Load' } }
                    }
                }
            });
        });

    </script>
</body>
</html>